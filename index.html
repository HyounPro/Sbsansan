<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ìˆ˜ê°•ìƒ ê°œê°•ì•ˆë‚´ ìë™ ìƒì„± (fetch ë°©ì‹)</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      padding: 40px;
      line-height: 1.8;
    }
    input {
      padding: 6px;
      width: 300px;
      margin: 10px 0;
    }
    button {
      padding: 6px 12px;
      margin-left: 10px;
    }
    pre {
      background: #f4f4f4;
      padding: 20px;
      border-radius: 5px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

  <h2>ğŸ“˜ SBSì»´í“¨í„°ì•„íŠ¸í•™ì› ê°œê°•ì•ˆë‚´ ìƒì„±ê¸°</h2>

  <label for="subjectInput">ê³¼ëª©ëª…ì„ ì½¤ë§ˆ(,)ë¡œ ì…ë ¥í•˜ì„¸ìš”:</label><br>
  <input type="text" id="subjectInput" placeholder="ì˜ˆ: ì˜¤ì „ì¼ëŸ¬ìŠ¤íŠ¸, ì˜¤ì „í¬í† ìƒµ">
  <button onclick="generate()">ìƒì„±</button>

  <h3>ğŸ“ ì•ˆë‚´ë¬¸ ìë™ ìƒì„± ê²°ê³¼</h3>
  <pre id="output"></pre>

  <script>
    let courseData = [];

    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTYdUa8OjpFuhycdQ-NWK4EciYYt1CH0YykLHn9hlE5yCK1SKsYgHzWHkZghd3bnkBL_WiGAoyFGp3t/pub?output=csv';

    const roomLinks = {
      'A': 'https://discord.gg/UbPVxWgcct',
      'B': 'https://discord.gg/VBaPncjxXe',
      'C': 'https://discord.gg/2WcQwuzvxy',
      'D': 'https://discord.gg/bHxVuv3AxS',
      'E': 'https://discord.gg/AsV8M6P79c',
      'F': 'https://discord.gg/cEDxpq6aVS',
      'G': 'https://discord.gg/KrHJzzErWt',
      'H': 'ë¹„ëŒ€ë©´ ìˆ˜ì—…ì´ ë¶ˆê°€ëŠ¥í•œ ê°•ì˜ì¥ì…ë‹ˆë‹¤.'
    };

    const scheduleToPeriod = {
      "ì›”ìˆ˜ê¸ˆ9": "06.13~07.07",
      "í™”ëª©ê¸ˆ9": "06.12~07.04",
      "ì›”ìˆ˜ê¸ˆ10": "06.13~07.09",
      "í™”ëª©ê¸ˆ10": "06.12~07.08",
      "ì›”ëª©": "06.12~07.09",
      "ê¸ˆ": "06.13~07.04",
      "ì›”í™”ìˆ˜ëª©": "05.13~06.10"
    };

    async function fetchCSV() {
      const response = await fetch(csvUrl);
      const text = await response.text();
      const rows = text.trim().split('\n');
      const headers = rows[0].split(',');
      courseData = rows.slice(1).map(row => {
        const values = row.split(',');
        const entry = {};
        headers.forEach((header, i) => {
          entry[header.trim()] = values[i]?.trim();
        });
        return entry;
      });
    }

    async function generate() {
      if (courseData.length === 0) {
        await fetchCSV();
      }

      const input = document.getElementById("subjectInput").value;
      const subjects = input.split(',').map(s => s.trim()).filter(Boolean);
      if (subjects.length === 0) {
        document.getElementById("output").textContent = "ê³¼ëª©ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.";
        return;
      }

      let message = `ğŸ“¢ SBSì»´í“¨í„°ì•„íŠ¸í•™ì› ì•ˆì‚°ì  ê°œê°•ì•ˆë‚´\n\n`;

      subjects.forEach(subject => {
        const row = courseData.find(item => item['ê³¼ëª©ëª…'] === subject);
        if (!row) {
          message += `âš  ê³¼ëª© "${subject}"ì˜ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n`;
          return;
        }

        const schedule = row['ì‹œê°„í‘œìœ í˜•'];
        const period = scheduleToPeriod[schedule] || 'ìˆ˜ê°•ê¸°ê°„ ë¯¸ì •';
        const time = row['ìˆ˜ì—…ì‹œê°„'] || 'ì‹œê°„ ë¯¸ì •';
        const room = row['ê°•ì˜ì¥']?.toUpperCase();
        const link = roomLinks[room] || 'ë¹„ëŒ€ë©´ ë§í¬ ì •ë³´ ì—†ìŒ';

        message += `
Â· ìˆ˜ê°•ê³¼ëª© : ${row['ê³¼ëª©ëª…']}
Â· ìˆ˜ê°•ê¸°ê°„ : ${period}
Â· ìˆ˜ê°•ì‹œê°„ : ${time}
Â· ê°•ì˜ì‹¤ : 3ì¸µ ${room}ê°•ì˜ì¥ 
Â· ë¹„ëŒ€ë©´ë§í¬ : ${room}ê°•ì˜ì¥ ${link}
Â· ëŒ€ë©´/ë¹„ëŒ€ë©´ : ëŒ€ë©´\n\n`;
      });

      message += `âš  ë³€ë™ ì‚¬í•­ ë°œìƒ ì‹œ, ìˆ˜ì—… ì „ ì¬ ì•ˆë‚´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤

í™•ì¸ í›„ì— ëŒ€ë©´/ë¹„ëŒ€ë©´/ì°¸ì„ ì—¬ë¶€ í™•ì¸ ë‹µì¥ ë¶€íƒë“œë¦½ë‹ˆë‹¤ğŸ˜Š

ê²©ì¼ì‹œê°„í‘œ/ì˜¨ë¼ì¸ê°•ì˜/ë¹„ëŒ€ë©´ë§í¬/êµì¬êµ¬ì…ë“± ìì„¸í•œ ë‚´ìš©ì€ ê³µì§€ì‚¬í•­ ë§í¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”!

â–¼SBSì•„ì¹´ë°ë¯¸ì»´í“¨í„°ì•„íŠ¸í•™ì› ì•ˆì‚°ì§€ì  ì¸ìŠ¤íƒ€ê·¸ë¨
https://www.instagram.com/sbsacademy_ansan/
íŒ”ë¡œìš° í•˜ì‹œê³  í•™ì›ì†Œì‹, ë¬´ë£ŒíŠ¹ê°•ì¼ì •, ì·¨ì—…ì •ë³´ë¥¼ í™•ì¸í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤ :)`;

      document.getElementById("output").textContent = message;
    }

  </script>

</body>
</html>
